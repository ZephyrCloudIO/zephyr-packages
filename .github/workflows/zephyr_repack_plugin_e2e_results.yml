name: Process Zephyr Repack Plugin E2E Test Results

on:
  workflow_dispatch:
    inputs:
      workflow_status:
        description: "Status of the overall E2E tests workflow"
        required: true
      commit_sha:
        description: "Commit SHA"
        required: true
      run_url:
        description: "URL to the workflow run"
        required: true
      zephyr_deployment_ios_status:
        description: "Status of zephyr-deployment-ios"
        required: true
      ios_tests_status:
        description: "Status of ios-tests"
        required: true
      zephyr_deployment_android_status:
        description: "Status of zephyr-deployment-android"
        required: true
      android_tests_status:
        description: "Status of android-tests"
        required: true
      ios_logs_url:
        description: "Logs URL for iOS E2E tests job"
        required: true
      android_logs_url:
        description: "Logs URL for Android E2E tests job"
        required: true

jobs:
  process-results:
    runs-on: ubuntu-latest
    steps:
      - name: Display Workflow Summary
        run: |
          echo "🔍 **E2E Test Results Summary**"
          echo "📌 **Overall Status:** ${{ github.event.inputs.workflow_status }}"
          echo "🔗 **Commit SHA:** ${{ github.event.inputs.commit_sha }}"
          echo "🔗 **Full E2E Workflow Logs:** ${{ github.event.inputs.run_url }}"

          echo "📱 **iOS Zephyr Deployment Status:** ${{ github.event.inputs.zephyr_deployment_ios_status }}"
          echo "🧪 **iOS E2E Tests Status:** ${{ github.event.inputs.ios_tests_status }}"
          echo "🔗 **iOS E2E Tests Logs:** ${{ github.event.inputs.ios_logs_url }}"

          echo "🤖 **Android Zephyr Deployment Status:** ${{ github.event.inputs.zephyr_deployment_android_status }}"
          echo "🧪 **Android E2E Tests Status:** ${{ github.event.inputs.android_tests_status }}"
          echo "🔗 **Android E2E Tests Logs:** ${{ github.event.inputs.android_logs_url }}"

      - name: Fail if Any E2E Job Failed
        if: github.event.inputs.workflow_status != 'success'
        run: |
          echo "❌ One or more E2E workflow related job failed! Check the logs in `zephyr-repack-example` repo."
          exit 1
